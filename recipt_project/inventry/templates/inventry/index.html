

{% extends "inventry/layout.html" %}

{% block body %}
<div>
    <div class="search-bar-container">
        <input type="text" id="searchInput" placeholder="Search...">
        <select id="searchSection" onchange="autoSearch()">
            <option value="" disabled selected>Search to select</option>
            <option value="prod_code">Product Code</option>
            <option value="product_description">Product Description</option>
            <option value="prod_quant">Quantity</option>
            <option value="prod_sale_price">Price</option>
            <option value="quantity_price_sale">Total for Each Item</option>
            <option value="updated_datetime">Date Time</option>
            <option value="added_by_employ">Added / Updated by</option>
        </select>
        <div class="actions">
    <a href="{% url 'inventry:add' %}" class="action-button">Add New Item</a>
    <button onclick="printReceipt()" class="action-button print-button">Print Receipt</button>
</div>

    </div>
    
</div>


    <div id="index_outer_div" class="receipt-details">
        <div>
            <ol>
                <br>

                {% if products %}
                <a href="{% url 'inventry:index' %}" class="hover-effect"><h3 style="margin-top: 8px;">Product Code</h3></a>
                {% for product in products %}
                <li style="margin-left: 15px;">{{ product.0 }}</li>
                <br>
                {% endfor %}
                {% else %}
                <h1>No items added</h1>
                {% endif %}
            </ol>
        </div>

        <div class="receipt-section">
            <br>
            {% if products %}
            {% if sorted_as == '0product_description' %}
            <a href="{% url 'inventry:inventry_sort' 1 'product_description' %}" class="hover-effect"><h3>Product description</h3></a>
            {% else %}
            <a href="{% url 'inventry:inventry_sort' 0 'product_description' %}" class="hover-effect"><h3>Product description</h3></a>
            {% endif %}
            {% for product in products %}
            <span class="description-preview" title="{{ product.1 }}">{{ product.1|truncatewords:2 }}</span>
            <br><br>
            {% endfor %}
            {% endif %}
        </div>

        <div class="receipt-section">
            <br>
            {% if products %}
            {% if sorted_as == '0prod_quant' %}
            <a href="{% url 'inventry:inventry_sort' 1 'prod_quant' %}" class="hover-effect"><h3>Quantity</h3></a>
            {% else %}
            <a href="{% url 'inventry:inventry_sort' 0 'prod_quant' %}" class="hover-effect"><h3>Quantity</h3></a>
            {% endif %}
            {% for product in products %}
            {{ product.2 }}
            <br><br>
            {% endfor %}
            {% endif %}
        </div>

        <div class="receipt-section">
            <br>
            {% if products %}
            {% if sorted_as == '0prod_sale_price' %}
            <a href="{% url 'inventry:inventry_sort' 1 'prod_sale_price' %}" class="hover-effect"><h3>Price</h3></a>
            {% else %}
            <a href="{% url 'inventry:inventry_sort' 0 'prod_sale_price' %}" class="hover-effect"><h3>Price</h3></a>
            {% endif %}
            {% for product in products %}
            {{ product.3 }}
            <br><br>
            {% endfor %}
            {% endif %}
        </div>

        <div class="receipt-section">
            <br>
            {% if products %}
            {% if sorted_as == '0quantity_price_sale' %}
            <a href="{% url 'inventry:inventry_sort' 1 'quantity_price_sale' %}" class="hover-effect"><h3>Total for Each Item</h3></a>
            {% else %}
            <a href="{% url 'inventry:inventry_sort' 0 'quantity_price_sale' %}" class="hover-effect"><h3>Total for Each Item</h3></a>
            {% endif %}
            {% for product in products %}
            {{ product.4 }}
            <br><br>
            {% endfor %}
            {% endif %}
        </div>

        <div class="receipt-section">
            <br>
            {% if products %}
            {% if sorted_as == '0updated_datetime' %}
            <a href="{% url 'inventry:inventry_sort' 1 'updated_datetime' %}" class="hover-effect"><h3>Date time</h3></a>
            {% else %}
            <a href="{% url 'inventry:inventry_sort' 0 'updated_datetime' %}" class="hover-effect"><h3>Date time</h3></a>
            {% endif %}
            {% for product in products %}
            {{ product.5 }}
            <br><br>
            {% endfor %}
            {% endif %}
        </div>

        <div class="receipt-section">
            <br>
            {% if products %}
            {% if sorted_as == '0added_by_employ' %}
            <a href="{% url 'inventry:inventry_sort' 1 'added_by_employ' %}" class="hover-effect"><h3>Added / Updated by</h3></a>
            {% else %}
            <a href="{% url 'inventry:inventry_sort' 0 'added_by_employ' %}" class="hover-effect"><h3>Added / Updated by</h3></a>
            {% endif %}
            {% for product in products %}
            {{ product.6 }}
            <br><br>
            {% endfor %}
            {% endif %}
        </div>

        <div class="receipt-actions">
            <br><br>
            {% for product in products %}
            <a href="{% url 'inventry:dele' forloop.counter0 product.0 %}" class="delete-button">
                <img src="https://icon-library.com/images/icon-remove/icon-remove-18.jpg" alt="DEL"
                        style="width: 16px; height: 22px; margin-bottom: 10px; margin-right: 10px;">
            </a>
            <a href="{% url 'inventry:edit_product' forloop.counter0 product.0 %}" class="edit-button">
                <img src="https://th.bing.com/th/id/OIP.P6trHImFdjGgSXQBU7_sagHaHa?rs=1&pid=ImgDetMain" alt="EDIT"
                        style="width: 16px; height: 22px; margin-bottom: 10px; margin-right: 10px;">
            </a>
            <br>
            {% endfor %}
        </div>
    </div>
</div>


<script>
    function printReceipt() {
        window.print();
    }
</script>
<script>
    const searchUrl = "{% url 'inventry:search_view' %}";  // Store the URL in a variable

    function autoSearch() {
        const query = document.getElementById('searchInput').value;
        const section = document.getElementById('searchSection').value;
        
        // Check if the search input is not empty before redirecting
        if (query.trim() !== "") {
            window.location.href = `${searchUrl}?q=${query}&section=${section}`;  // Use the variable here
        }
    }

    // Optional: Trigger search when pressing Enter in the input field
    document.getElementById('searchInput').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            autoSearch();
        }
    });

    function printReceipt() {
        window.print();
    }
</script>

{% endblock %}
